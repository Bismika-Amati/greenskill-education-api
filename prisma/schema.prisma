// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Role {
  id        String    @id @default(uuid())
  name      String    @unique
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  deletedAt DateTime?
  user      User[]
}

model Province {
  id        String    @id @default(uuid())
  name      String
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  deletedAt DateTime?
  village   Village[]
  user      User[]
  city      City[]
}

model City {
  id         String     @id @default(uuid())
  name       String
  provinceId String
  createdAt  DateTime   @default(now())
  updatedAt  DateTime   @updatedAt
  deletedAt  DateTime?
  province   Province   @relation(fields: [provinceId], references: [id])
  districts  District[]
  village    Village[]
  user       User[]
}

model District {
  id          String        @id @default(uuid())
  name        String
  cityId      String
  createdAt   DateTime      @default(now())
  updatedAt   DateTime      @updatedAt
  deletedAt   DateTime?
  city        City          @relation(fields: [cityId], references: [id])
  village     Village[]
  user        User[]
  subDistrict SubDistrict[]
}

model SubDistrict {
  id         String    @id @default(uuid())
  name       String
  districtId String
  createdAt  DateTime  @default(now())
  updatedAt  DateTime  @updatedAt
  deletedAt  DateTime?
  districts  District  @relation(fields: [districtId], references: [id])
  village    Village[]
  user       User[]
}

model User {
  id            String         @id @default(uuid())
  fullname      String
  email         String         @unique
  password      String
  phoneNumber   String?        @db.VarChar(15)
  photo         String?
  roleId        String
  provinceId    String?
  cityId        String?
  districtId    String?
  subDistrictId String?
  postcode      String?
  address       String?
  createdAt     DateTime       @default(now())
  updatedAt     DateTime       @updatedAt
  deletedAt     DateTime?
  role          Role           @relation(fields: [roleId], references: [id])
  province      Province?      @relation(fields: [provinceId], references: [id])
  city          City?          @relation(fields: [cityId], references: [id])
  district      District?      @relation(fields: [districtId], references: [id])
  subDistrict   SubDistrict?   @relation(fields: [subDistrictId], references: [id])
  village       Village[]
  userCourse    UserCourse[]
  doneModule    DoneModule[]
  forum         Forum[]
  forumComment  ForumComment[]
}

model Village {
  id               String             @id @default(uuid())
  name             String             @unique
  description      String?            @db.Text
  provinceId       String
  cityId           String
  districtId       String
  subDistrictId    String
  postcode         String
  address          String
  latlong          String
  picId            String
  createdAt        DateTime           @default(now())
  updatedAt        DateTime           @updatedAt
  deletedAt        DateTime?
  pic              User               @relation(fields: [picId], references: [id])
  province         Province           @relation(fields: [provinceId], references: [id])
  city             City               @relation(fields: [cityId], references: [id])
  district         District           @relation(fields: [districtId], references: [id])
  subDistrict      SubDistrict        @relation(fields: [subDistrictId], references: [id])
  villagePicture   VillagePicture[]
  problemStatement ProblemStatement[]
}

model VillagePicture {
  id        String    @id @default(uuid())
  photo     String
  villageId String
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  deletedAt DateTime?
  village   Village   @relation(fields: [villageId], references: [id])
}

model ProblemStatement {
  id                  String                @id @default(uuid())
  topic               String
  description         String?               @db.Text
  villageId           String
  createdAt           DateTime              @default(now())
  updatedAt           DateTime              @updatedAt
  deletedAt           DateTime?
  village             Village               @relation(fields: [villageId], references: [id])
  existingAlternative ExistingAlternative[]
}

model ExistingAlternative {
  id                 String           @id @default(uuid())
  title              String
  description        String?          @db.Text
  problemStatementId String
  createdAt          DateTime         @default(now())
  updatedAt          DateTime         @updatedAt
  deletedAt          DateTime?
  problemStatement   ProblemStatement @relation(fields: [problemStatementId], references: [id])
}

model Course {
  id                 String       @id @default(uuid())
  title              String
  description        String?      @db.Text
  amount             Float
  photo              String?
  estimateCompleated Int
  createdAt          DateTime     @default(now())
  updatedAt          DateTime     @updatedAt
  deletedAt          DateTime?
  userCourse         UserCourse[]
  subModule          SubModule[]
  forum              Forum[]
}

model UserCourse {
  id         String    @id @default(uuid())
  rating     Int?
  feedback   String?
  experience String?   @db.Text
  userId     String
  courseId   String
  createdAt  DateTime  @default(now())
  updatedAt  DateTime  @updatedAt
  deletedAt  DateTime?
  user       User      @relation(fields: [userId], references: [id])
  course     Course    @relation(fields: [courseId], references: [id])
}

model SubModule {
  id               String             @id @default(uuid())
  number           Int
  title            String
  description      String?            @db.Text
  video            String?
  picture          String?
  courseId         String
  createdAt        DateTime           @default(now())
  updatedAt        DateTime           @updatedAt
  deletedAt        DateTime?
  course           Course             @relation(fields: [courseId], references: [id])
  doneModule       DoneModule[]
  articleSubModule ArticleSubModule[]
}

model ArticleSubModule {
  id          String    @id @default(uuid())
  title       String
  description String    @db.Text
  picture     String?
  video       String?
  subModuleId String
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  deletedAt   DateTime?
  subModule   SubModule @relation(fields: [subModuleId], references: [id])
}

model DoneModule {
  id          String    @id @default(uuid())
  userId      String
  subModuleId String
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  deletedAt   DateTime?
  user        User      @relation(fields: [userId], references: [id])
  subModule   SubModule @relation(fields: [subModuleId], references: [id])
}

model Forum {
  id           String         @id @default(uuid())
  title        String
  description  String
  userId       String
  courseId     String
  forumTypeId  String
  createdAt    DateTime       @default(now())
  updatedAt    DateTime       @updatedAt
  deletedAt    DateTime?
  user         User           @relation(fields: [userId], references: [id])
  course       Course         @relation(fields: [courseId], references: [id])
  forumType    ForumType      @relation(fields: [forumTypeId], references: [id])
  dorumComment ForumComment[]
}

model ForumType {
  id        String    @id @default(uuid())
  name      String
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  deletedAt DateTime?
  dorum     Forum[]
}

model ForumComment {
  id          String    @id @default(uuid())
  description String    @db.Text
  forumId     String
  userId      String
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  deletedAt   DateTime?
  forum       Forum     @relation(fields: [forumId], references: [id])
  user        User      @relation(fields: [userId], references: [id])
}
